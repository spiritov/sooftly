import"../chunks/DsnmJJEf.js";import{S as ue,aa as oe,u as A,T as R,ah as Y,ab as o,ae as n,af as i,ac as w,O as g,ai as G,a9 as l,ag as f,ad as se,x as X,a7 as he,a8 as le}from"../chunks/BvyEtBnD.js";import{s as D}from"../chunks/Cp0nVd2g.js";import{i as F}from"../chunks/CT2Gfhmu.js";import{k as E,s as W,a as e,e as Z,i as ee,b as pe,t as L,c as ge,f as K}from"../chunks/Ckz4K-ML.js";const a=ue({leftStart:!1,rightStart:!1,leftFinish:!1,rightFinish:!1,leftFinishTime:0,rightFinishTime:0,resetPulse:!1});var me=o("<span> </span>"),be=o("<span> </span>"),_e=o('<div class="absolute flex h-32 w-full items-center justify-center gap-36"><!> <!></div>');function xe(I,N){oe(N,!0);let P=Y(0),M=Y(0),z=G(()=>C(g(P))),Q=G(()=>C(g(M)));function C(d){const s=Math.floor(d/6e3).toString().padStart(2,"0"),m=Math.floor(d/100%60).toString().padStart(2,"0"),k=Math.floor(d%100).toString().padStart(2,"0");return`${s}:${m}.${k}`}A(()=>{if(a.leftStart&&!a.leftFinish){const d=Math.floor(Date.now()/10),s=setInterval(()=>{R(P,Math.floor(Date.now()/10-d),!0)},77);return()=>{clearInterval(s)}}}),A(()=>{if(a.rightStart&&!a.rightFinish){const d=Date.now()/10,s=setInterval(()=>{R(M,Math.floor(Date.now()/10-d),!0)},77);return()=>{clearInterval(s)}}}),A(()=>{a.resetPulse&&(R(P,0),R(M,0),a.resetPulse=!1)});var V=_e(),J=n(V);E(J,()=>[a.leftStart,a.leftFinish],d=>{var s=me(),m=n(s,!0);i(s),w(k=>{W(s,1,`${a.leftStart?"text-palewhite":"text-palewhite/50"} font-chivomono text-center text-5xl transition-colors duration-2000`),D(m,k)},[()=>a.leftFinish?C(a.leftFinishTime):g(z)]),l(d,s)});var q=f(J,2);E(q,()=>[a.rightStart,a.rightFinish],d=>{var s=be(),m=n(s,!0);i(s),w(k=>{W(s,1,`${a.rightStart?"text-palewhite":"text-palewhite/50"} font-chivomono text-center text-5xl transition-colors duration-2000`),D(m,k)},[()=>a.rightFinish?C(a.rightFinishTime):g(Q)]),l(d,s)}),i(V),l(I,V),se()}const we=I=>{var N=Ne();Z(N,20,()=>({length:2}),ee,(P,M)=>{var z=We();l(P,z)}),i(N),L(3,N,()=>ge),l(I,N)};var ke=o('<img class="relative z-50 flex h-24 w-fit rounded-lg" alt="flag"/>'),Se=o("<span> </span>"),$e=o("<div></div>"),ye=o('<div class="border-palewhite/50 size-8 border-4"></div>'),Te=o('<span class="relative bottom-0.5 text-3xl opacity-50"> </span>'),Fe=o('<div><div></div> <div id="spacer"></div> <!> <div class="flex flex-col gap-2 text-5xl"><!> <div><!> <!> <!></div></div></div>'),We=o('<div class="flex basis-1/2 items-center justify-center border-white text-3xl first:border-r-[1px]">960x540px</div>'),Ne=o('<div class="bg-palewhite/50 flex h-[540px] w-full"></div>'),Pe=o('<div class="absolute flex h-15 w-full"><span class="absolute w-full justify-center self-center text-center">vs</span> <!> <!></div>'),Oe=o('<span class="relative left-2 flex w-full skew-x-[30deg] items-center justify-center py-3"> </span>'),je=o('<div class="bg-fullblack/90 border-palewhite/50 relative right-8 min-w-64 skew-x-[-30deg] rounded-br-xl border-r-4 border-b-4 px-12"><!></div>'),De=o('<span class="relative right-2 flex w-full skew-x-[-30deg] justify-center py-3"> </span>'),Me=o('<div class="bg-fullblack/90 border-palewhite/50 relative left-8 ml-auto min-w-64 skew-x-[30deg] rounded-bl-xl border-b-4 border-l-4 px-12"><!></div>'),ze=o('<div class="text-palewhite/75 relative flex h-16 w-full justify-between text-3xl"><!> <!> <!></div>'),Ce=o('<div class="relative basis-1/2 items-center justify-center gap-4"><div></div> <span> </span></div>'),Ve=o(`<span class="absolute z-999 h-screen w-full bg-black/60 p-64 text-4xl">WebSocket connecting... <span class="text-palewhite/60 text-3xl">(if this takes more than a few seconds after setting the token, it's likely failed.)</span></span>`),Re=o('<span class="absolute z-999 h-screen w-full bg-black/60 p-64 text-4xl opacity-0 transition-opacity delay-1000 duration-1000 starting:opacity-100">WebSocket connected.</span>'),Ge=o("<!> <!>",1),Ie=o('<div><div class="relative flex h-32 w-full shrink-0"><!> <!> <!></div> <!> <!></div>');function qe(I,N){oe(N,!0);const P=(t,r=X)=>{var u=Fe(),S=n(u),$=f(S,4);{var y=c=>{var x=ke();w(()=>pe(x,"src",`https://countryflagsapi.netlify.app/flag/${e[r()+"Flag"]??""}.svg`)),l(c,x)};F($,c=>{e[r()+"Flag"]&&c(y)})}var h=f($,2),b=n(h);{var p=c=>{var x=he(),j=le(x);E(j,()=>e[r()+"Name"],ce=>{var H=Se(),de=n(H,!0);i(H),w(()=>D(de,e[r()+"Name"].name)),L(1,H,()=>K),l(ce,H)}),l(c,x)};F(b,c=>{e[r()+"Name"]&&c(p)})}var v=f(b,2),T=n(v);Z(T,17,()=>({length:e[r()+"Score"]}),ee,(c,x)=>{var j=$e();w(()=>W(j,1,`starting:border-palewhite/50 starting:bg-overlay-orange/0 border-palewhite/50 bg-overlay-orange size-8 border-4 transition-colors duration-1000 ${e.useTeamColors?"":`hue-rotate-${e.hueRotate}`}`)),l(c,j)});var O=f(T,2);Z(O,17,()=>({length:e.maxScore-e[r()+"Score"]}),ee,(c,x)=>{var j=ye();l(c,j)});var _=f(O,2);{var B=c=>{var x=Te(),j=n(x);i(x),w(()=>D(j,`PR ${e[r()+"PR"]??""}`)),l(c,x)};F(_,c=>{e.usePR&&c(B)})}i(v),i(h),i(u),w(()=>{W(u,1,`relative flex basis-1/2 items-center gap-4 ${r()==="left"?"flex-row text-left":"flex-row-reverse text-right"}`),W(S,1,`absolute -z-10 h-full w-full ${r()==="left"?`bg-linear-to-r/oklch ${e.useTeamColors?g(V):g(q)}`:`bg-linear-to-l/oklch ${e.useTeamColors?g(J):g(d)}`}`),W(v,1,`flex gap-2 ${r()==="left"?"flex-row":"flex-row-reverse"}`)}),l(t,u)},M=t=>{var r=ze(),u=n(r);{var S=p=>{var v=Pe(),T=f(n(v),2);z(T,()=>"left");var O=f(T,2);z(O,()=>"right"),i(v),l(p,v)};F(u,p=>{e.useTeams&&p(S)})}var $=f(u,2);{var y=p=>{var v=je(),T=n(v);E(T,()=>e.stage,O=>{var _=Oe(),B=n(_,!0);i(_),w(()=>D(B,e.stage)),L(1,_,()=>K),l(O,_)}),i(v),l(p,v)};F($,p=>{e.stage&&p(y)})}var h=f($,2);{var b=p=>{var v=Me(),T=n(v);E(T,()=>e.map,O=>{var _=De(),B=n(_,!0);i(_),w(()=>D(B,e.map)),L(1,_,()=>K),l(O,_)}),i(v),l(p,v)};F(h,p=>{e.map&&p(b)})}i(r),l(t,r)},z=(t,r=X,u=X)=>{var S=Ce(),$=n(S),y=f($,2),h=n(y,!0);i(y),i(S),w(b=>{W($,1,`absolute -z-10 h-full w-full ${b??""}`),W(y,1,`text-palewhite absolute z-10 flex h-full w-full items-center justify-center text-4xl text-nowrap ${r()==="left"?"flex-row-reverse":"flex-row"}`),D(h,e[r()+"Team"])},[()=>r()==="left"?` bg-linear-to-r/oklch ${(e.useTeamColors?g(V):g(q)).replace("to-fullblack/60","to-fullblack/0")} to-90%`:` bg-linear-to-l/oklch ${(e.useTeamColors?g(J):g(d)).replace("to-fullblack/60","to-fullblack/0")} to-90%`]),l(t,S)};function Q(){a.leftStart=!1,a.rightStart=!1,a.leftFinish=!1,a.rightFinish=!1,a.resetPulse=!0}function C(t){switch(t.type){case"timer_start":`${t.steamid}`===e.leftName.steamid?(a.leftFinish=!1,a.leftStart=!0):`${t.steamid}`===e.rightName.steamid&&(a.leftFinish=!1,a.rightStart=!0);break;case"timer_finish":`${t.steamid}`===e.leftName.steamid?(a.leftFinish=!0,a.leftFinishTime=Math.round(t.time*100)):`${t.steamid}`===e.rightName.steamid&&(a.rightFinish=!0,a.rightFinishTime=Math.round(t.time*100));break}}let V=G(()=>`from-tf-blu ${e.useSinglePOV?" to-fullblack/0":" to-fullblack/60"} to-75%`),J=G(()=>`from-tf-red ${e.useSinglePOV?" to-fullblack/0":" to-fullblack/60"} to-75%`),q=G(()=>`from-overlay-orange/90 ${e.useSinglePOV?" to-fullblack/0":" to-fullblack/60"} to-75% hue-rotate-${e.hueRotate}`),d=G(()=>`from-overlay-orange/90 ${e.useSinglePOV?" to-fullblack/0":" to-fullblack/60"} to-75% hue-rotate-${e.hueRotate}`),s=Y(!1),m;{for(const[t,r]of Object.entries(e))e[t]=JSON.parse(localStorage.getItem(t));window.addEventListener("storage",t=>{e[t.key]=JSON.parse(t.newValue)}),A(()=>{if(e.useWebSocket&&e.useWebSocketToken!==""){const t=e.useWebSocketToken;m=new WebSocket(`wss://flyio-silent-sea-6505.fly.dev/?token=${t}`),m.onopen=r=>{console.log("[WebSocket] connection opened."),R(s,!0)},m.onmessage=r=>{const u=JSON.parse(r.data);console.log("[WebSocket] received data..",u),C(u)}}return()=>{m&&(m.close(),console.log("[WebSocket] closed previous connection."),R(s,!1))}}),e.useWebSocket&&e.useWebSocketToken!==""&&A(()=>{e.leftName,e.rightName,Q()})}var k=Ie(),U=n(k),te=n(U);{var ie=t=>{var r=Ge(),u=le(r);xe(u,{});var S=f(u,2);{var $=h=>{var b=Ve();L(1,b,()=>K),l(h,b)},y=h=>{var b=Re();l(h,b)};F(S,h=>{g(s)?h(y,!1):h($)})}l(t,r)};F(te,t=>{e.useWebSocket&&e.useWebSocketToken!==""&&e.leftName.steamid&&e.rightName.steamid&&t(ie)})}var ae=f(te,2);P(ae,()=>"left");var ne=f(ae,2);P(ne,()=>"right"),i(U);var re=f(U,2);{var fe=t=>{we(t)};F(re,t=>{e.useSinglePOV||t(fe)})}var ve=f(re,2);M(ve),i(k),w(t=>W(k,1,`font-${t??""} flex h-screen w-screen flex-col overflow-hidden`),[()=>e.font.toLowerCase()]),l(I,k),se()}export{qe as component};
