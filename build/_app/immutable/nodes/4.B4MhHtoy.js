import"../chunks/DsnmJJEf.js";import{S as ue,z as le,u as L,T as R,ab as Y,ah as n,ai as i,ag as k,O as m,ak as G,aj as f,A as se,v as X,af as oe}from"../chunks/DrV9e9eg.js";import{s as z}from"../chunks/cAXu-K16.js";import{f as l,d as o,b as he}from"../chunks/Cb6xlI_z.js";import{i as F}from"../chunks/9cl3-o1j.js";import{k as E,s as W,e as Z,i as ee,a as pe,t as B,b as me,f as K}from"../chunks/Cjjqt-0Q.js";import{s as e}from"../chunks/DiToUoMq.js";const a=ue({leftStart:!1,rightStart:!1,leftFinish:!1,rightFinish:!1,leftFinishTime:0,rightFinishTime:0,resetPulse:!1});var ge=l("<span> </span>"),be=l("<span> </span>"),_e=l('<div class="absolute flex h-32 w-full items-center justify-center gap-36"><!> <!></div>');function xe(I,N){le(N,!0);let P=Y(0),D=Y(0),M=G(()=>V(m(P))),Q=G(()=>V(m(D)));function V(d){const s=Math.floor(d/6e3).toString().padStart(2,"0"),g=Math.floor(d/100%60).toString().padStart(2,"0"),w=Math.floor(d%100).toString().padStart(2,"0");return`${s}:${g}.${w}`}L(()=>{if(a.leftStart&&!a.leftFinish){const d=Math.floor(Date.now()/10),s=setInterval(()=>{R(P,Math.floor(Date.now()/10-d),!0)},77);return()=>{clearInterval(s)}}}),L(()=>{if(a.rightStart&&!a.rightFinish){const d=Date.now()/10,s=setInterval(()=>{R(D,Math.floor(Date.now()/10-d),!0)},77);return()=>{clearInterval(s)}}}),L(()=>{a.resetPulse&&(R(P,0),R(D,0),a.resetPulse=!1)});var C=_e(),J=n(C);E(J,()=>[a.leftStart,a.leftFinish],d=>{var s=ge(),g=n(s,!0);i(s),k(w=>{W(s,1,`${a.leftStart?"text-palewhite":"text-palewhite/50"} font-chivomono text-center text-5xl transition-colors duration-2000`),z(g,w)},[()=>a.leftFinish?V(a.leftFinishTime):m(M)]),o(d,s)});var q=f(J,2);E(q,()=>[a.rightStart,a.rightFinish],d=>{var s=be(),g=n(s,!0);i(s),k(w=>{W(s,1,`${a.rightStart?"text-palewhite":"text-palewhite/50"} font-chivomono text-center text-5xl transition-colors duration-2000`),z(g,w)},[()=>a.rightFinish?V(a.rightFinishTime):m(Q)]),o(d,s)}),i(C),o(I,C),se()}const ke=I=>{var N=Ne();Z(N,20,()=>({length:2}),ee,(P,D)=>{var M=We();o(P,M)}),i(N),B(3,N,()=>me),o(I,N)};var we=l('<img class="relative z-50 flex h-24 w-fit rounded-lg" alt="flag"/>'),Se=l("<span> </span>"),$e=l("<div></div>"),ye=l('<div class="border-palewhite/50 size-8 border-4"></div>'),Te=l('<span class="relative bottom-0.5 text-3xl opacity-50"> </span>'),Fe=l('<div><div></div> <div id="spacer"></div> <!> <div class="flex flex-col gap-2 text-5xl"><!> <div><!> <!> <!></div></div></div>'),We=l('<div class="flex basis-1/2 items-center justify-center border-white text-3xl first:border-r-[1px]">960x540px</div>'),Ne=l('<div class="bg-palewhite/50 flex h-[540px] w-full"></div>'),Pe=l('<div class="absolute flex h-15 w-full"><span class="absolute w-full justify-center self-center text-center">vs</span> <!> <!></div>'),Oe=l('<span class="relative left-2 flex w-full skew-x-[30deg] items-center justify-center py-3"> </span>'),je=l('<div class="bg-fullblack/90 border-palewhite/50 relative right-8 min-w-64 skew-x-[-30deg] rounded-br-xl border-r-4 border-b-4 px-12"><!></div>'),ze=l('<span class="relative right-2 flex w-full skew-x-[-30deg] justify-center py-3"> </span>'),De=l('<div class="bg-fullblack/90 border-palewhite/50 relative left-8 ml-auto min-w-64 skew-x-[30deg] rounded-bl-xl border-b-4 border-l-4 px-12"><!></div>'),Me=l('<div class="text-palewhite/75 relative flex h-16 w-full justify-between text-3xl"><!> <!> <!></div>'),Ve=l('<div class="relative basis-1/2 items-center justify-center gap-4"><div></div> <span> </span></div>'),Ce=l(`<span class="absolute z-999 h-screen w-full bg-black/60 p-64 text-4xl">WebSocket connecting... <span class="text-palewhite/60 text-3xl">(if this takes more than a few seconds after setting the token, it's likely failed.)</span></span>`),Re=l('<span class="absolute z-999 h-screen w-full bg-black/60 p-64 text-4xl opacity-0 transition-opacity delay-1000 duration-1000 starting:opacity-100">WebSocket connected.</span>'),Ge=l("<!> <!>",1),Ie=l('<div><div class="relative flex h-32 w-full shrink-0"><!> <!> <!></div> <!> <!></div>');function Ke(I,N){le(N,!0);const P=(t,r=X)=>{var u=Fe(),S=n(u),$=f(S,4);{var y=c=>{var x=we();k(()=>pe(x,"src",`https://countryflagsapi.netlify.app/flag/${e[r()+"Flag"]??""}.svg`)),o(c,x)};F($,c=>{e[r()+"Flag"]&&c(y)})}var h=f($,2),b=n(h);{var p=c=>{var x=he(),j=oe(x);E(j,()=>e[r()+"Name"],ce=>{var H=Se(),de=n(H,!0);i(H),k(()=>z(de,e[r()+"Name"].name)),B(1,H,()=>K),o(ce,H)}),o(c,x)};F(b,c=>{e[r()+"Name"]&&c(p)})}var v=f(b,2),T=n(v);Z(T,17,()=>({length:e[r()+"Score"]}),ee,(c,x)=>{var j=$e();k(()=>W(j,1,`starting:border-palewhite/50 starting:bg-overlay-orange/0 border-palewhite/50 bg-overlay-orange size-8 border-4 transition-colors duration-1000 ${e.useTeamColors?"":`hue-rotate-${e.hueRotate}`}`)),o(c,j)});var O=f(T,2);Z(O,17,()=>({length:e.maxScore-e[r()+"Score"]}),ee,(c,x)=>{var j=ye();o(c,j)});var _=f(O,2);{var A=c=>{var x=Te(),j=n(x);i(x),k(()=>z(j,`PR ${e[r()+"PR"]??""}`)),o(c,x)};F(_,c=>{e.usePR&&c(A)})}i(v),i(h),i(u),k(()=>{W(u,1,`relative flex basis-1/2 items-center gap-4 ${r()==="left"?"flex-row text-left":"flex-row-reverse text-right"}`),W(S,1,`absolute -z-10 h-full w-full ${r()==="left"?`bg-linear-to-r/oklch ${e.useTeamColors?m(C):m(q)}`:`bg-linear-to-l/oklch ${e.useTeamColors?m(J):m(d)}`}`),W(v,1,`flex gap-2 ${r()==="left"?"flex-row":"flex-row-reverse"}`)}),o(t,u)},D=t=>{var r=Me(),u=n(r);{var S=p=>{var v=Pe(),T=f(n(v),2);M(T,()=>"left");var O=f(T,2);M(O,()=>"right"),i(v),o(p,v)};F(u,p=>{e.useTeams&&!e.useSinglePOV&&p(S)})}var $=f(u,2);{var y=p=>{var v=je(),T=n(v);E(T,()=>e.stage,O=>{var _=Oe(),A=n(_,!0);i(_),k(()=>z(A,e.stage)),B(1,_,()=>K),o(O,_)}),i(v),o(p,v)};F($,p=>{e.stage&&p(y)})}var h=f($,2);{var b=p=>{var v=De(),T=n(v);E(T,()=>e.map,O=>{var _=ze(),A=n(_,!0);i(_),k(()=>z(A,e.map)),B(1,_,()=>K),o(O,_)}),i(v),o(p,v)};F(h,p=>{e.map&&p(b)})}i(r),o(t,r)},M=(t,r=X,u=X)=>{var S=Ve(),$=n(S),y=f($,2),h=n(y,!0);i(y),i(S),k(b=>{W($,1,`absolute -z-10 h-full w-full ${b??""}`),W(y,1,`text-palewhite absolute z-10 flex h-full w-full items-center justify-center text-4xl text-nowrap ${r()==="left"?"flex-row-reverse":"flex-row"}`),z(h,e[r()+"Team"])},[()=>r()==="left"?` bg-linear-to-r/oklch ${(e.useTeamColors?m(C):m(q)).replace("to-fullblack/60","to-fullblack/0")} to-90%`:` bg-linear-to-l/oklch ${(e.useTeamColors?m(J):m(d)).replace("to-fullblack/60","to-fullblack/0")} to-90%`]),o(t,S)};function Q(){a.leftStart=!1,a.rightStart=!1,a.leftFinish=!1,a.rightFinish=!1,a.resetPulse=!0}function V(t){switch(t.type){case"timer_start":`${t.steamid}`===e.leftName.steamid?(a.leftFinish=!1,a.leftStart=!0):`${t.steamid}`===e.rightName.steamid&&(a.leftFinish=!1,a.rightStart=!0);break;case"timer_finish":`${t.steamid}`===e.leftName.steamid?(a.leftFinish=!0,a.leftFinishTime=Math.round(t.time*100)):`${t.steamid}`===e.rightName.steamid&&(a.rightFinish=!0,a.rightFinishTime=Math.round(t.time*100));break}}let C=G(()=>`from-tf-blu ${e.useSinglePOV?" to-fullblack/0":" to-fullblack/60"} to-75%`),J=G(()=>`from-tf-red ${e.useSinglePOV?" to-fullblack/0":" to-fullblack/60"} to-75%`),q=G(()=>`from-overlay-orange/90 ${e.useSinglePOV?" to-fullblack/0":" to-fullblack/60"} to-75% hue-rotate-${e.hueRotate}`),d=G(()=>`from-overlay-orange/90 ${e.useSinglePOV?" to-fullblack/0":" to-fullblack/60"} to-75% hue-rotate-${e.hueRotate}`),s=Y(!1),g;{for(const[t,r]of Object.entries(e))e[t]=JSON.parse(localStorage.getItem(t));window.addEventListener("storage",t=>{e[t.key]=JSON.parse(t.newValue)}),L(()=>{if(e.useWebSocket&&e.useWebSocketToken!==""){const t=e.useWebSocketToken;g=new WebSocket(`wss://flyio-silent-sea-6505.fly.dev/?token=${t}`),g.onopen=r=>{console.log("[WebSocket] connection opened."),R(s,!0)},g.onmessage=r=>{const u=JSON.parse(r.data);console.log("[WebSocket] received data..",u),V(u)}}return()=>{g&&(g.close(),console.log("[WebSocket] closed previous connection."),R(s,!1))}}),e.useWebSocket&&e.useWebSocketToken!==""&&L(()=>{e.leftName,e.rightName,Q()})}var w=Ie(),U=n(w),te=n(U);{var ie=t=>{var r=Ge(),u=oe(r);xe(u,{});var S=f(u,2);{var $=h=>{var b=Ce();B(1,b,()=>K),o(h,b)},y=h=>{var b=Re();o(h,b)};F(S,h=>{m(s)?h(y,!1):h($)})}o(t,r)};F(te,t=>{e.useWebSocket&&e.useWebSocketToken!==""&&e.leftName.steamid&&e.rightName.steamid&&t(ie)})}var ae=f(te,2);P(ae,()=>"left");var ne=f(ae,2);P(ne,()=>"right"),i(U);var re=f(U,2);{var fe=t=>{ke(t)};F(re,t=>{e.useSinglePOV||t(fe)})}var ve=f(re,2);D(ve),i(w),k(t=>W(w,1,`font-${t??""} flex h-screen w-screen flex-col overflow-hidden`),[()=>e.font.toLowerCase()]),o(I,w),se()}export{Ke as component};
